<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.539">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Econ4261 - Group Project</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Econ4261</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Lectures.html"> 
<span class="menu-text">Lecture Slides</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Recitations.html"> 
<span class="menu-text">Recitation Materials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Data.html"> 
<span class="menu-text">Data</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-homework" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Homework</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-homework">    
        <li>
    <a class="dropdown-item" href="../assignments/GroupProject.html">
 <span class="dropdown-text">Group Project</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../assignments/Homework-1.html">
 <span class="dropdown-text">Homework 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../assignments/Homework-2.html">
 <span class="dropdown-text">Homework 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../assignments/Homework-3.html">
 <span class="dropdown-text">Homework 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../assignments/Homework-4.html">
 <span class="dropdown-text">Homework 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../assignments/Homework-5.html">
 <span class="dropdown-text">Homework 5</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#project-description" id="toc-project-description" class="nav-link active" data-scroll-target="#project-description">Project Description</a>
  <ul class="collapse">
  <li><a href="#group-presentation" id="toc-group-presentation" class="nav-link" data-scroll-target="#group-presentation">Group Presentation</a></li>
  <li><a href="#written-report" id="toc-written-report" class="nav-link" data-scroll-target="#written-report">Written report</a></li>
  <li><a href="#project-outline" id="toc-project-outline" class="nav-link" data-scroll-target="#project-outline">Project Outline</a></li>
  </ul></li>
  <li><a href="#project-timeline" id="toc-project-timeline" class="nav-link" data-scroll-target="#project-timeline">Project Timeline</a></li>
  <li><a href="#rules-for-submission" id="toc-rules-for-submission" class="nav-link" data-scroll-target="#rules-for-submission">Rules for Submission</a></li>
  <li><a href="#suggested-list-of-topics" id="toc-suggested-list-of-topics" class="nav-link" data-scroll-target="#suggested-list-of-topics">Suggested List of Topics</a></li>
  <li><a href="#finding-data-and-replication-materials" id="toc-finding-data-and-replication-materials" class="nav-link" data-scroll-target="#finding-data-and-replication-materials">Finding Data and Replication Materials</a></li>
  <li><a href="#grading-criteria" id="toc-grading-criteria" class="nav-link" data-scroll-target="#grading-criteria">Grading Criteria</a></li>
  <li><a href="#econ-capstone-level-writing-criteria" id="toc-econ-capstone-level-writing-criteria" class="nav-link" data-scroll-target="#econ-capstone-level-writing-criteria">ECON Capstone-level writing criteria</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Group Project</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="project-description" class="level2">
<h2 class="anchored" data-anchor-id="project-description">Project Description</h2>
<p>In groups of 5 to 6, you will use the tools we have learned in this course to conduct a quantitative analysis on a topic of your choice. This analysis may be your own original work, or a replication of an existing paper.</p>
<section id="group-presentation" class="level3">
<h3 class="anchored" data-anchor-id="group-presentation">Group Presentation</h3>
<p>Each group will deliver a 10-15 minute presentation of their findings in class.</p>
</section>
<section id="written-report" class="level3">
<h3 class="anchored" data-anchor-id="written-report">Written report</h3>
<p>Although you will work together to conduct the analysis, you will <strong>write and submit your own individual reports</strong>. The report should be 3-5 pages including references, figures, and tables.</p>
</section>
<section id="project-outline" class="level3">
<h3 class="anchored" data-anchor-id="project-outline">Project Outline</h3>
<p>Both the presentation and your individual reports should use the following structure.</p>
<ol type="1">
<li>Introduction
<ol type="1">
<li>What is the empirical question you are attempting to answer?</li>
<li>Describe why (using citations when necessary) this question is of interest. If possible, describe the economic theory underlying your question and how your analysis will help quantify it.</li>
<li>Provide a brief literature review (a cogent summary of 2-3 papers that highlights the key points) on this topic.</li>
<li>Specify the method of analysis you are going to use (linear regression, instrumental variables, difference in differences, etc). If you are replicating a paper, specify which paper.</li>
</ol></li>
<li>Data
<ol type="1">
<li>Describe how the data you are using for your analysis is constructed, including any sample selection criteria.</li>
<li>Provide a descriptive analysis of the data, including an analysis of the cross-sectional relationship between your outcome variable of interest and the causal variable of interest in your question.</li>
</ol></li>
<li>Main Analysis
<ol type="1">
<li>Explain why the cross-sectional relationship that you demonstrated in section (2) may not reflect a causal relationship.</li>
<li>Describe the method you are going to use to answer your question and <strong>clearly</strong> articulate the assumptions under which this method correctly estimates a causal relationship between the two variables.</li>
<li>Present the analysis and discuss results.</li>
</ol></li>
</ol>
</section>
</section>
<section id="project-timeline" class="level2">
<h2 class="anchored" data-anchor-id="project-timeline">Project Timeline</h2>
<table class="table">
<colgroup>
<col style="width: 42%">
<col style="width: 57%">
</colgroup>
<thead>
<tr class="header">
<th>Week</th>
<th>Deadline</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Week 3</td>
<td>Teams are formed and groups discuss topics</td>
</tr>
<tr class="even">
<td>Week 4</td>
<td>Meeting 1 with WA: teams discuss topic with WA</td>
</tr>
<tr class="odd">
<td>Week 5</td>
<td>Meeting 2: teams find 2-3 relevant papers on the topic</td>
</tr>
<tr class="even">
<td>Week 6</td>
<td>Meeting 3: teams establish data source</td>
</tr>
<tr class="odd">
<td>Week 7</td>
<td>Teams finalize research question, data source, and related papers</td>
</tr>
<tr class="even">
<td></td>
<td>Spring Break</td>
</tr>
<tr class="odd">
<td>Week 8</td>
<td>Teams work on descriptive analysis</td>
</tr>
<tr class="even">
<td>Week 9</td>
<td>Meeting 4: teams meet with WA to get feedback on descriptive analysis</td>
</tr>
<tr class="odd">
<td>Week 10</td>
<td>Teams work on descriptive analysis and main (causal) analysis</td>
</tr>
<tr class="even">
<td>Week 11</td>
<td>Teams work on main (causal) analysis</td>
</tr>
<tr class="odd">
<td>Week 12</td>
<td>Meeting 5: teams meet with WA to get feedback on main analysis</td>
</tr>
<tr class="even">
<td>Week 13</td>
<td>Meeting 6: teams meet with WA to get feedback on presentation</td>
</tr>
<tr class="odd">
<td>Week 14</td>
<td>Group presentations</td>
</tr>
<tr class="even">
<td>Week 15</td>
<td>Individuals finalize written reports with feedback from WA (due date May 5)</td>
</tr>
</tbody>
</table>
</section>
<section id="rules-for-submission" class="level2">
<h2 class="anchored" data-anchor-id="rules-for-submission">Rules for Submission</h2>
<ol type="1">
<li>Written reports that are identical will not be graded.</li>
<li>There is no advantage in grading for original work vs a replication, but in both cases you will be assessed on your ability to use tools critically and independently. There is scope for providing original analysis and insight in the replication study also.</li>
<li>Students must submit <strong>both</strong> their written report as well as the code they used to generate the results in their report. Students in the same group are allowed to submit the same code if their analysis is identical.</li>
</ol>
</section>
<section id="suggested-list-of-topics" class="level2">
<h2 class="anchored" data-anchor-id="suggested-list-of-topics">Suggested List of Topics</h2>
<p>If you are struggling to come up with questions for your research project, here is a suggested list of topics where there is plenty of existing research for you to build on/replicate. These are just to get you going, you can adjust the question to fit your interests and any constraints on available data.</p>
<ul>
<li>What is the impact of rent control on housing supply?</li>
<li>What are the impacts of changes in divorce laws on divorce rates and child outcomes?</li>
<li>What impacts did welfare reform in the US in the 1990s have on labor supply and welfare participation?</li>
<li>What impacts did expansions in the Earned Income Tax Credit (or other tax changes) have on labor supply and earnings?</li>
<li>What are the effects of job loss/displacement on future earnings?</li>
<li>What are the impacts of job training programs on labor market outcomes?</li>
<li>What effects have increases in trade competition had on prices, earnings, or other outcomes?</li>
<li>What effect do increases in minimum wages have on wages/employment?</li>
<li>What is the effect of mergers on industrial concentration, prices, and wages?</li>
<li>What are the effects of job polarization on wages/earnings/employment/education decisions?</li>
<li>What are the impacts of <span class="math inline">\(x\)</span> in early life on skill outcomes and/or future outcomes where <span class="math inline">\(x\)</span> could be:
<ul>
<li>Cash transfers to poor households</li>
<li>Pollution</li>
<li>Lead exposure</li>
<li>Provision of high qulity childcare</li>
<li>Access to affordable health care</li>
<li>School quality</li>
</ul></li>
</ul>
</section>
<section id="finding-data-and-replication-materials" class="level2">
<h2 class="anchored" data-anchor-id="finding-data-and-replication-materials">Finding Data and Replication Materials</h2>
<p>Most journals in economics require authors to provide replication materials, including data (when these sources are not confidential). Some journals in which you may find interesting empirical topics from the last ten years include the American Economic Review (plus the associated journals of AER:Macro, AER:Micro, AER:Applied, and AER:Policy), Econometrica, the Quarterly Journal of Economics, the Journal of Political Economy, the Review of Economic Studies, the Journal of Labor Economics, the Journal of Public Economics, and Economic Journal. The websites for these journals host all replication materials.</p>
</section>
<section id="grading-criteria" class="level2">
<h2 class="anchored" data-anchor-id="grading-criteria">Grading Criteria</h2>
<p>The project is worth 20% of the course grade in total with the following breakdown:</p>
<ul>
<li>Groups receive 1% for each meeting with their Writing Assistant (5% total).</li>
<li>Group presentation (5%)</li>
<li>Individual writeup (10%)</li>
</ul>
</section>
<section id="econ-capstone-level-writing-criteria" class="level2">
<h2 class="anchored" data-anchor-id="econ-capstone-level-writing-criteria">ECON Capstone-level writing criteria</h2>
<ol type="1">
<li>Concisely summarizes the essential information about the project.</li>
<li>Applies a standard economics paper layout with an introduction (includes research question and thesis), discussion, data, model, and regressions to test the model, results, and conclusion sections as appropriate to the setting.</li>
<li>Explain the connection between the hypothesis and the chosen model, explain what proof would confirm or disprove the hypothesis, and justify the use of the selected model.</li>
<li>Identifies appropriate data from reputable sources; uses an appropriate sample size; and cites all sources used.</li>
<li>Develops a brief literature review that demonstrates an understanding of the relevance of the proposed hypothesis and its relationship to current knowledge.</li>
<li>Uses mathematical equations or technical language accurately to explain models and effects.</li>
<li>States and interprets all results of regressions and explains clearly how the results confirm or disprove the hypothesis/model.</li>
<li>When presenting empirical research, explains equations and the intuition behind the choice of independent and dependent variables.</li>
<li>Uses appropriate formatting (graphs and tables are labeled accurately) and language conventions (e.g.&nbsp;no spelling or grammatical errors).</li>
</ol>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>